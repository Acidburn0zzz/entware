--- ../../../downloads/openwrt_trunk-r46338/feeds/packages/multimedia/tvheadend/Makefile	2015-07-15 10:59:15.583750134 +0300
+++ ../../../openwrt_trunk/feeds/packages/multimedia/tvheadend/Makefile	2015-07-15 12:45:26.199856589 +0300
@@ -79,19 +79,23 @@
 	$(call Build/Prepare/Default)
 	echo 'Tvheadend $(shell echo $(PKG_SOURCE_VERSION) | sed "s/^v//")~openwrt$(PKG_RELEASE)' \
 		> $(PKG_BUILD_DIR)/debian/changelog
+	$(SED) "s|0.0.0~unknown|$(PKG_VERSION)|g" $(PKG_BUILD_DIR)/support/version
 endef
 
 define Package/conffiles
-/etc/config/tvheadend
+/opt/etc/config/tvheadend
 endef
 
 define Package/tvheadend/install
-	$(INSTALL_DIR) $(1)/etc/init.d
-	$(INSTALL_BIN) ./files/tvheadend.init $(1)/etc/init.d/tvheadend
-	$(INSTALL_DIR) $(1)/etc/config
-
-	$(INSTALL_DIR) $(1)/usr/bin
-	$(INSTALL_BIN) $(PKG_BUILD_DIR)/build.linux/tvheadend $(1)/usr/bin/
+	$(INSTALL_DIR) $(1)/opt/etc/init.d
+	$(INSTALL_BIN) ./files/S71tvheadend $(1)/opt/etc/init.d/
+	$(INSTALL_DIR) $(1)/opt/etc/tvheadend
+	$(INSTALL_CONF) ./files/tv_grab_wl500g_info.{cfg,offset} $(1)/opt/etc/
+	$(INSTALL_DIR) $(1)/opt/bin
+	$(INSTALL_BIN) $(PKG_BUILD_DIR)/build.linux/tvheadend $(1)/opt/bin/
+	$(INSTALL_BIN) ./files/tv_grab_wl500g_info{,_toffset} $(1)/opt/bin/
+	$(INSTALL_DIR) $(1)/opt/share/tvheadend
+	$(CP) -r $(PKG_INSTALL_DIR)/opt/share/tvheadend/* $(1)/opt/share/tvheadend
 endef
 
 $(eval $(call BuildPackage,tvheadend))
