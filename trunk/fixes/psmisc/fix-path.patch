--- ../../../backup/trunk_clean/feeds/packages/utils/psmisc/Makefile	2012-01-18 17:41:20.000000000 +0400
+++ ../../../trunk/feeds/packages/utils/psmisc/Makefile	2012-01-19 13:35:25.796296129 +0400
@@ -38,25 +38,17 @@
 	CPPFLAGS="$(TARGET_CPPFLAGS)" \
 	LDFLAGS="$(TARGET_LDFLAGS)" \
 
-define Package/psmisc/preinst
-#!/bin/sh
-if [ -e $${IPKG_INSTROOT}/usr/bin/killall ]; then
-  rm $${IPKG_INSTROOT}/usr/bin/killall;
-fi
-endef
+CONFIGURE_ARGS += \
+	--localedir=/opt/share/locale \
+	--disable-nls \
+	ac_cv_func_malloc_0_nonnull=yes \
+	ac_cv_func_realloc_0_nonnull=yes \
 
 define Package/psmisc/install
-	$(INSTALL_DIR) $(1)/usr/bin
+	$(INSTALL_DIR) $(1)/opt/bin
 	$(INSTALL_BIN) \
-		$(PKG_INSTALL_DIR)/usr/bin/{fuser,killall,peekfd,prtstat,pstree} \
-		$(1)/usr/bin/
-endef
-
-define Package/psmisc/postrm
-#!/bin/sh
-ln -sf ../../bin/busybox $${IPKG_INSTROOT}/usr/bin/killall
-$${IPKG_INSTROOT}/usr/bin/killall 2>&1 | grep 'applet not found' > /dev/null 2>&1 && rm $${IPKG_INSTROOT}/usr/bin/killall
-exit 0
+		$(PKG_INSTALL_DIR)/opt/bin/{fuser,killall,peekfd,prtstat,pstree} \
+		$(1)/opt/bin/
 endef
 
 $(eval $(call BuildPackage,psmisc))
