--- a/scripts/checks.m4	2012-03-31 14:49:47.042089620 +0400
+++ b/scripts/checks.m4	2012-03-31 14:50:04.848966205 +0400
@@ -96,7 +96,7 @@
 AC_DEFUN([TORRENT_CHECK_KQUEUE_SOCKET_ONLY], [
   AC_MSG_CHECKING(whether kqueue supports pipes and ptys)
 
-  AC_RUN_IFELSE([AC_LANG_SOURCE([
+  AC_LINK_IFELSE([AC_LANG_SOURCE([
       #include <fcntl.h>
       #include <stdlib.h>
       #include <unistd.h>
